<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>üê∞ Giorno 16 ‚Äì Garden Race 30 ‚Üí 0</title>

<link href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;700&display=swap" rel="stylesheet">

<style>
:root{
  --grass:#7bc043;
  --grass-dark:#4caf50;
  --tile:#f9f1dc;
  --tile-edge:#d7ccc8;
  --hole:#111;
  --wood:#6d4c41;
  --win:#ffeb3b;
}

*{box-sizing:border-box;-webkit-tap-highlight-color:transparent}

body{
  margin:0;
  font-family:'Ubuntu',sans-serif;
  background:#e3f2fd;
  display:flex;
  flex-direction:column;
  align-items:center;
  padding:10px;
  overflow:hidden;
}

h1{
  margin:6px 0 8px;
  font-size:22px;
  color:#1b5e20;
  font-weight:800;
}

.wrap{
  width:100%;
  max-width:520px;
  display:flex;
  flex-direction:column;
  align-items:center;
  gap:8px;
}

/* TANE */
.baseRow{
  width:100%;
  display:flex;
  justify-content:space-between;
}

.base{
  width:160px;
  height:90px;
  background:#a1887f;
  border:4px solid var(--wood);
  border-radius:18px;
  display:flex;
  flex-wrap:wrap;
  align-items:center;
  justify-content:center;
  gap:6px;
  position:relative;
}

.baseLabel{
  position:absolute;
  top:-18px;
  left:10px;
  font-size:12px;
  font-weight:800;
  color:var(--wood);
}

/* BOARD */
#board{
  width:100%;
  height:60vh;
  background:var(--grass);
  border:10px solid var(--grass-dark);
  border-radius:30px;
  position:relative;
  box-shadow:0 14px 28px rgba(0,0,0,.2);
}

/* CASELLE */
.tile{
  width:54px;
  height:54px;
  background:var(--tile);
  border-radius:16px;
  position:absolute;
  display:flex;
  align-items:center;
  justify-content:center;
  font-weight:900;
  font-size:18px;
  color:#3e2723;
  border-bottom:6px solid var(--tile-edge);
  box-shadow:0 6px 0 rgba(0,0,0,.1);
}

.hole{
  background:var(--hole);
  border-bottom-color:#000;
  box-shadow:inset 0 8px 16px rgba(0,0,0,.7);
}
.hole span{display:none}

/* ZERO */
#finish{
  width:80px;
  height:80px;
  background:var(--win);
  border:5px solid #fbc02d;
  border-radius:24px;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  box-shadow:0 0 22px rgba(255,235,59,.6);
}
#finish .carrot{font-size:36px}
#finish .zero{font-size:12px;font-weight:900}

/* CONIGLI */
.bunny{
  width:40px;
  height:40px;
  border-radius:14px;
  position:absolute;
  background-size:contain;
  background-repeat:no-repeat;
  background-position:center;
  filter:drop-shadow(0 4px 4px rgba(0,0,0,.25));
  transition:.35s;
}
.player{background-image:url('img/rabbit_1.png')}
.cpu{background-image:url('img/rabbit_2.png')}

.pickable{
  outline:4px solid #fff;
  box-shadow:0 0 0 6px rgba(255,152,0,.4);
}

/* UI */
.controls{
  width:100%;
  max-width:520px;
  margin-top:8px;
}
#msg{
  background:#fff;
  padding:14px;
  border-radius:60px;
  border:3px solid var(--grass-dark);
  font-weight:800;
}
button{
  width:100%;
  margin-top:8px;
  padding:16px;
  border:none;
  border-radius:60px;
  background:#ff9800;
  color:#fff;
  font-size:20px;
  font-weight:900;
  box-shadow:0 8px 0 #e65100;
}
button:disabled{background:#ccc;box-shadow:0 6px 0 #999}
</style>
</head>

<body>

<h1>üê∞ GARDEN RACE 30 ‚Üí 0</h1>

<div class="wrap">

  <!-- TANA PC -->
  <div class="baseRow">
    <div class="base" id="cpuBase"><div class="baseLabel">TANA PC</div></div>
    <div style="width:160px"></div>
  </div>

  <!-- BOARD -->
  <div id="board"></div>

  <!-- ZERO IN BASSO -->
  <div id="finish">
    <div class="carrot">ü•ï</div>
    <div class="zero">0</div>
  </div>

  <!-- TANA PLAYER -->
  <div class="baseRow">
    <div style="width:160px"></div>
    <div class="base" id="playerBase"><div class="baseLabel">TANA TUA</div></div>
  </div>

</div>

<div class="controls">
  <div id="msg">Tira il dado per iniziare!</div>
  <button id="diceBtn">üé≤ TIRA IL DADO</button>
</div>

<script>
const board=document.getElementById("board");
const diceBtn=document.getElementById("diceBtn");
const msg=document.getElementById("msg");
const playerBase=document.getElementById("playerBase");
const cpuBase=document.getElementById("cpuBase");

/* MAPPA 30 ‚Üí 1 */
const pos={
30:[15,10],29:[40,10],28:[65,10],27:[85,14],
24:[85,28],23:[65,28],22:[40,28],21:[15,28],
20:[15,42],19:[40,42],18:[65,42],17:[85,42],
14:[85,56],13:[65,56],12:[40,56],11:[15,56],
10:[15,70],9:[40,70],8:[65,70],7:[85,70],
6:[85,86],5:[65,86],4:[40,86],3:[25,86],2:[15,90],1:[10,90]
};

const holes=[18,9,5];
const bunnies=[];
let turn="player",state="idle",dice=0;

/* DISEGNA CASELLE */
for(let n=30;n>=1;n--){
  if(!pos[n])continue;
  const d=document.createElement("div");
  d.className="tile"+(holes.includes(n)?" hole":"");
  d.style.left=`calc(${pos[n][0]}% - 27px)`;
  d.style.top=`calc(${pos[n][1]}% - 27px)`;
  const s=document.createElement("span");s.textContent=n;
  d.appendChild(s);
  board.appendChild(d);
}

/* CREA CONIGLI */
function makeBunny(owner,i){
  const b=document.createElement("div");
  b.className=`bunny ${owner}`;
  b.dataset.owner=owner;
  b.dataset.pos=-1;
  b.dataset.idx=i;
  b.onclick=()=>select(b);
  (owner==="player"?playerBase:cpuBase).appendChild(b);
  bunnies.push(b);
}
for(let i=0;i<4;i++){makeBunny("player",i);makeBunny("cpu",i);}

/* AGGIORNA POS */
function update(b){
  const p=+b.dataset.pos;
  if(p===-1)return;
  board.appendChild(b);
  const [x,y]=p===0?[50,105]:pos[p];
  b.style.left=`calc(${x}% - 20px)`;
  b.style.top=`calc(${y}% - 20px)`;
}

/* DADO */
diceBtn.onclick=()=>{
  if(state!=="idle")return;
  dice=Math.floor(Math.random()*6)+1;
  msg.innerHTML=`üé≤ √à uscito <b>${dice}</b>`;
  state="move";
  setTimeout(()=>turn==="player"?pick():cpuMove(),500);
};

function pick(){
  msg.innerHTML+="<br>Tocca un coniglio";
  bunnies.forEach(b=>{
    if(b.dataset.owner==="player")b.classList.add("pickable");
  });
}

function select(b){
  if(state!=="move"||b.dataset.owner!=="player")return;
  bunnies.forEach(x=>x.classList.remove("pickable"));
  move(b);
}

function move(b){
  let p=+b.dataset.pos;
  if(p===-1)p=30;
  let n=p-dice;
  if(n<=0){b.dataset.pos=0;update(b);win(b.dataset.owner);return;}
  b.dataset.pos=n;update(b);
  if(dice===6&&holes.includes(n)){
    setTimeout(()=>{b.dataset.pos=-1;location.reload()},600);
  }
  endTurn();
}

function cpuMove(){
  const cpu=bunnies.filter(b=>b.dataset.owner==="cpu");
  move(cpu[0]);
}

function endTurn(){
  turn=turn==="player"?"cpu":"player";
  state="idle";
  msg.textContent=turn==="player"?"Tocca a te":"Turno PC";
  if(turn==="cpu")setTimeout(()=>diceBtn.onclick(),600);
}

function win(w){
  msg.textContent=w==="player"?"üèÜ HAI VINTO!":"ü§ñ VINCE IL PC";
  diceBtn.disabled=true;
}
</script>

</body>
</html>