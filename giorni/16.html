<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ðŸŽ„ Christmas Garden Race</title>

<link href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;700&display=swap" rel="stylesheet">

<style>
/* ===== BASE ===== */
body {
  margin: 0;
  font-family: 'Ubuntu', sans-serif;
  background: linear-gradient(#1b5e20, #2e7d32);
}

.game {
  max-width: 430px;
  margin: 0 auto;
  height: 100vh;
  display: flex;
  flex-direction: column;
  background: #fefefe;
}

/* ===== HEADER ===== */
.header {
  background: linear-gradient(135deg, #b71c1c, #e53935);
  color: #fff;
  padding: 14px;
  text-align: center;
  border-bottom: 3px solid gold;
}

.header h1 {
  margin: 0;
  font-size: 22px;
}

.status {
  display: flex;
  justify-content: space-between;
  font-size: 14px;
  margin-top: 6px;
}

/* ===== BOARD GRID ===== */
.board {
  flex: 1;
  padding: 12px;
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 10px;
  background: #7bc96f;
  border-radius: 16px;
  margin: 10px;
}

/* ===== CELLS ===== */
.cell {
  background: #fff8e1;
  border-radius: 16px;
  height: 64px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 18px;
  font-weight: bold;
  position: relative;
  box-shadow: inset 0 0 0 2px #c62828;
}

.cell.start { background: #e3f2fd; }
.cell.finish { background: #fff3e0; }

.cell.special {
  background: #e8f5e9;
}

.cell .icon {
  position: absolute;
  top: 4px;
  left: 6px;
  font-size: 16px;
}

.players {
  position: absolute;
  bottom: 4px;
  right: 6px;
  font-size: 20px;
}

/* ===== MESSAGE ===== */
.message {
  background: #ffffff;
  padding: 12px;
  text-align: center;
  font-weight: bold;
  border-top: 2px solid #c62828;
}

/* ===== BUTTON ===== */
.action {
  background: linear-gradient(135deg, #2e7d32, #43a047);
  color: #fff;
  border: none;
  padding: 16px;
  font-size: 18px;
  font-weight: bold;
  cursor: pointer;
}

.action:disabled {
  background: #9e9e9e;
}
</style>
</head>

<body>

<div class="game">

<header class="header">
  <h1>ðŸŽ„ Christmas Garden Race</h1>
  <div class="status">
    <span id="turno">Turno: TU</span>
    <span id="dado">Dado: â€”</span>
  </div>
</header>

<main class="board" id="board"></main>

<div class="message" id="message">ðŸŽ¯ Tira il dado</div>

<button class="action" id="actionBtn">ðŸŽ² TIRA IL DADO</button>

</div>

<script>
/* ===== ELEMENTI ===== */
const board = document.getElementById("board");
const message = document.getElementById("message");
const actionBtn = document.getElementById("actionBtn");
const turnoEl = document.getElementById("turno");
const dadoEl = document.getElementById("dado");

/* ===== STATO ===== */
let currentPlayer = 1;
let dado = 0;

const players = {
  1: { pos: 0, icon: "ðŸ°", skip: false },
  2: { pos: 0, icon: "ðŸŽ…", skip: false }
};

/* ===== CASELLE SPECIALI ===== */
const specialCells = {
  6:  { icon: "ðŸŽ", effect: "bonus" },
  13: { icon: "â„ï¸", effect: "skip" },
  18: { icon: "ðŸŽ„", effect: "bonus" },
  25: { icon: "â›”", effect: "skip" }
};

/* ===== CREA GRIGLIA 0â€“30 ===== */
for (let i = 30; i >= 0; i--) {
  const cell = document.createElement("div");
  cell.className = "cell";
  cell.dataset.num = i;
  cell.textContent = i;

  if (i === 0) cell.classList.add("start");
  if (i === 30) cell.classList.add("finish");

  if (specialCells[i]) {
    cell.classList.add("special");
    const icon = document.createElement("span");
    icon.className = "icon";
    icon.textContent = specialCells[i].icon;
    cell.appendChild(icon);
  }

  board.appendChild(cell);
}

/* ===== RENDER ===== */
function render() {
  document.querySelectorAll(".players").forEach(p => p.remove());

  for (let i = 0; i <= 30; i++) {
    const cell = document.querySelector(`.cell[data-num="${i}"]`);
    const here = Object.values(players).filter(p => p.pos === i);

    if (here.length) {
      const box = document.createElement("div");
      box.className = "players";
      here.forEach(p => box.textContent += p.icon);
      cell.appendChild(box);
    }
  }
}

/* ===== LOGICA ===== */
function rollDice() {
  dado = Math.floor(Math.random() * 6) + 1;
  dadoEl.textContent = "Dado: " + dado;
}

function applySpecial(player) {
  const cell = specialCells[players[player].pos];
  if (!cell) return;

  if (cell.effect === "bonus") {
    players[player].pos = Math.min(30, players[player].pos + 2);
    message.textContent = "ðŸŽ Bonus! +2";
  }
  if (cell.effect === "skip") {
    players[player].skip = true;
    message.textContent = "â„ï¸ Salti un turno";
  }
}

/* ===== TURNO TU ===== */
actionBtn.onclick = () => {
  if (currentPlayer !== 1) return;

  if (players[1].skip) {
    players[1].skip = false;
    message.textContent = "â­ Turno saltato";
    nextTurn();
    return;
  }

  rollDice();
  players[1].pos = Math.min(30, players[1].pos + dado);
  message.textContent = "ðŸ° Avanzi di " + dado;
  render();

  setTimeout(() => {
    applySpecial(1);
    render();
    nextTurn();
  }, 900);
};

/* ===== TURNO PC ===== */
function pcTurn() {
  turnoEl.textContent = "Turno: PC";
  actionBtn.disabled = true;

  setTimeout(() => {
    if (players[2].skip) {
      players[2].skip = false;
      message.textContent = "ðŸŽ… PC salta il turno";
      nextTurn();
      return;
    }

    rollDice();
    players[2].