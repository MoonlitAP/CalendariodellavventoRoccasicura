<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ğŸ„ Christmas Garden Race</title>

<link href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;700&display=swap" rel="stylesheet">

<style>
/* ===== BASE ===== */
body {
  margin: 0;
  font-family: 'Ubuntu', sans-serif;
  background: linear-gradient(#0b6623, #145a32);
}

.game {
  max-width: 420px;
  margin: 0 auto;
  height: 100vh;
  display: flex;
  flex-direction: column;
  background: #fefefe;
}

/* ===== HEADER ===== */
.header {
  background: linear-gradient(135deg, #b71c1c, #e53935);
  color: #fff;
  padding: 14px;
  text-align: center;
  border-bottom: 3px solid #ffd700;
}

.header h1 {
  margin: 0;
  font-size: 22px;
}

.status {
  display: flex;
  justify-content: space-between;
  font-size: 14px;
  margin-top: 6px;
}

/* ===== BOARD ===== */
.board {
  flex: 1;
  overflow-y: auto;
  padding: 12px;
  display: flex;
  flex-direction: column-reverse;
  gap: 8px;
  background: repeating-linear-gradient(
    45deg,
    #ffffff,
    #ffffff 10px,
    #f5f5f5 10px,
    #f5f5f5 20px
  );
}

/* ===== CELLS ===== */
.cell {
  height: 60px;
  background: #fff8e1;
  border-radius: 16px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 20px;
  font-weight: bold;
  position: relative;
  box-shadow: inset 0 0 0 2px #d32f2f;
}

.cell.special-gift { background: #e8f5e9; }
.cell.special-ice  { background: #e3f2fd; }
.cell.special-stop { background: #fce4ec; }

.cell .icon {
  position: absolute;
  top: 6px;
  left: 10px;
  font-size: 18px;
}

.rabbits {
  position: absolute;
  right: 10px;
  display: flex;
  gap: 4px;
  font-size: 22px;
}

/* ===== MESSAGE ===== */
.message {
  background: #fff;
  padding: 12px;
  text-align: center;
  font-weight: bold;
  min-height: 44px;
  border-top: 2px solid #c62828;
}

/* ===== BUTTON ===== */
.action {
  background: linear-gradient(135deg, #2e7d32, #43a047);
  color: #fff;
  border: none;
  padding: 16px;
  font-size: 18px;
  font-weight: bold;
  cursor: pointer;
}

.action:disabled {
  background: #9e9e9e;
  cursor: not-allowed;
}
</style>
</head>

<body>

<div class="game">

<header class="header">
  <h1>ğŸ„ Christmas Garden Race</h1>
  <div class="status">
    <span id="turno">Turno: TU</span>
    <span id="dado">Dado: â€”</span>
  </div>
</header>

<main class="board" id="board"></main>

<div class="message" id="message">ğŸ¯ Tira il dado</div>

<button class="action" id="actionBtn">ğŸ² TIRA IL DADO</button>

</div>

<script>
/* ===== DATI ===== */
const board = document.getElementById("board");
const message = document.getElementById("message");
const actionBtn = document.getElementById("actionBtn");
const turnoEl = document.getElementById("turno");
const dadoEl = document.getElementById("dado");

let currentPlayer = 1;
let dado = 0;

const players = {
  1: { pos: 1, icon: "ğŸ°", skip: false },
  2: { pos: 1, icon: "ğŸ…", skip: false }
};

/* ===== CASELLE SPECIALI NATALIZIE ===== */
const specialCells = {
  7:  { type: "gift", icon: "ğŸ" },   // avanza
  14: { type: "ice",  icon: "â„ï¸" },  // perdi turno
  21: { type: "gift", icon: "ğŸ„" },  // avanza
  26: { type: "stop", icon: "â›”" }   // stop
};

/* ===== CREA BOARD ===== */
for (let i = 1; i <= 30; i++) {
  const cell = document.createElement("div");
  cell.className = "cell";
  cell.dataset.num = i;
  cell.textContent = i;

  if (specialCells[i]) {
    cell.classList.add("special-" + specialCells[i].type);
    const icon = document.createElement("span");
    icon.className = "icon";
    icon.textContent = specialCells[i].icon;
    cell.appendChild(icon);
  }

  board.appendChild(cell);
}

/* ===== RENDER ===== */
function render() {
  document.querySelectorAll(".rabbits").forEach(r => r.remove());

  for (let i = 1; i <= 30; i++) {
    const cell = document.querySelector(`.cell[data-num="${i}"]`);
    const here = Object.values(players).filter(p => p.pos === i);

    if (here.length) {
      const box = document.createElement("div");
      box.className = "rabbits";
      here.forEach(p => box.textContent += p.icon);
      cell.appendChild(box);
    }
  }
}

/* ===== UTILS ===== */
function rollDice() {
  dado = Math.floor(Math.random() * 6) + 1;
  dadoEl.textContent = "Dado: " + dado;
}

function applySpecial(player) {
  const pos = players[player].pos;
  const sp = specialCells[pos];
  if (!sp) return;

  if (sp.type === "gift") {
    players[player].pos = Math.min(30, pos + 2);
    message.textContent = "ğŸ Regalo! Avanzi di 2";
  }
  if (sp.type === "ice") {
    players[player].skip = true;
    message.textContent = "â„ï¸ Ghiaccio! Salti un turno";
  }
  if (sp.type === "stop") {
    players[player].skip = true;
    message.textContent = "â›” Fermati! Turno perso";
  }
}

/* ===== TURNO GIOCATORE ===== */
actionBtn.onclick = () => {
  if (currentPlayer !== 1) return;

  if (players[1].skip) {
    players[1].skip = false;
    message.textContent = "â­ Turno saltato";
    nextTurn();
    return;
  }

  rollDice();
  players[1].pos = Math.min(30, players[1].pos + dado);
  message.textContent = "ğŸ° Avanzi di " + dado;
  render();

  setTimeout(() => {
    applySpecial(1);
    render();
    nextTurn();
  }, 900);
};

/* ===== TURNO PC ===== */
function pcTurn() {
  turnoEl.textContent = "Turno: PC";
  actionBtn.disabled = true;

  setTimeout(() => {
    if (players[2].skip) {
      players[2].skip = false;
      message.textContent = "ğŸ… PC salta il turno";
      nextTurn();
      return;
    }

    rollDice();
    players[2].pos = Math.min(30, players[2].pos + dado);
    message.textContent = "ğŸ… PC avanza di " + dado;
    render();

    setTimeout(() => {
      applySpecial(2);
      render();
      nextTurn();
    }, 900);

  }, 800);
}

/* ===== CAMBIO TURNO ===== */
function nextTurn() {
  if (players[currentPlayer].pos >= 30) {
    message.textContent = currentPlayer === 1
      ? "ğŸ‰ HAI VINTO! BUON NATALE!"
      : "ğŸ… VINCE BABBO NATALE!";
    actionBtn.disabled = true;
    return;
  }

  currentPlayer = currentPlayer === 1 ? 2 : 1;
  dadoEl.textContent = "Dado: â€”";

  if (currentPlayer === 1) {
    turnoEl.textContent = "Turno: TU";
    message.textContent = "ğŸ¯ Tira il dado";
    actionBtn.disabled = false;
  } else {
    message.textContent = "ğŸ… Turno del PCâ€¦";
    pcTurn();
  }
}

/* ===== START ===== */
render();
</script>

</body>
</html>