<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ğŸ„ Giorno 13 â€“ Buscaminas</title>

<link href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;700&display=swap" rel="stylesheet">

<style>
body {
  margin: 0;
  font-family: "Ubuntu", sans-serif;
  background: #1e1e2f;
  color: #fff;
  display: flex;
  justify-content: center;
  align-items: center;
  height: 100vh;
}

.container {
  text-align: center;
}

.controls {
  display: flex;
  gap: 10px;
  justify-content: center;
  margin-bottom: 10px;
}

button {
  padding: 10px 16px;
  font-size: 15px;
  border: none;
  border-radius: 6px;
  cursor: pointer;
}

.primary { background:#4da3ff; color:#fff; }
.flag { background:#ffcc00; }
.retry { background:#ffd369; margin-top:10px; }

.grid {
  display: grid;
  grid-template-columns: repeat(8, 42px);
  gap: 5px;
  margin: 15px auto;
}

.cell {
  width: 42px;
  height: 42px;
  background: #9aa3b2;
  border-radius: 4px;
  font-weight: bold;
  font-size: 18px;
  display: flex;
  justify-content: center;
  align-items: center;
  cursor: pointer;
}

.cell.revealed {
  background: #ffffff;
  cursor: default;
}

.cell.mine {
  background: #ff4b4b;
  color: #fff;
}

.n1{color:#007bff;}
.n2{color:#28a745;}
.n3{color:#dc3545;}
.n4{color:#6f42c1;}
.n5{color:#000;}

#message {
  font-size: 18px;
}

/* MODAL */
.modal {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.7);
  display: flex;
  justify-content: center;
  align-items: center;
}

.modal-content {
  background: #fff;
  color: #333;
  padding: 20px;
  border-radius: 10px;
  width: 90%;
  max-width: 320px;
  text-align: center;
}
</style>
</head>

<body>

<div class="modal" id="modal">
  <div class="modal-content">
    <h2>ğŸ„ Giorno 13 â€“ Buscaminas</h2>
    <p>
      ğŸ”¢ I numeri indicano quante bombe ci sono intorno.<br><br>
      ğŸ” <b>Scopri</b>: apri le caselle<br>
      ğŸš© <b>Segna bomba</b>: marca una bomba sospetta<br><br>
      ğŸ’£ Se tocchi una bomba perdi.
    </p>
    <button class="primary" onclick="startGame()">Inizia a giocare</button>
  </div>
</div>

<div class="container">
  <div id="message">Scegli una modalitÃ </div>

  <div class="controls">
    <button class="primary" onclick="mode='reveal'">ğŸ” Scopri</button>
    <button class="flag" onclick="mode='flag'">ğŸš© Segna bomba</button>
  </div>

  <div class="grid" id="grid"></div>

  <button class="retry" onclick="resetGame()">ğŸ”„ Riprova</button>
</div>

<script>
const rows=8, cols=8, minesCount=10;
let cells=[], mines=[], gameOver=false, mode="reveal";

const grid=document.getElementById("grid");
const message=document.getElementById("message");
const modal=document.getElementById("modal");

function startGame(){
  modal.style.display="none";
  resetGame();
}

function resetGame(){
  grid.innerHTML="";
  cells=[]; mines=[]; gameOver=false;
  message.textContent="Gioca con attenzione ğŸ§ ";

  while(mines.length<minesCount){
    let p=Math.floor(Math.random()*rows*cols);
    if(!mines.includes(p)) mines.push(p);
  }

  for(let i=0;i<rows*cols;i++){
    const c=document.createElement("div");
    c.className="cell";
    c.onclick=()=>clickCell(i);
    grid.appendChild(c);
    cells.push(c);
  }
}

function clickCell(i){
  if(gameOver) return;
  const c=cells[i];
  if(c.classList.contains("revealed")) return;

  if(mode==="flag"){
    c.textContent = c.textContent==="ğŸš©" ? "" : "ğŸš©";
    return;
  }

  c.classList.add("revealed");

  if(mines.includes(i)){
    c.textContent="ğŸ’£";
    c.classList.add("mine");
    message.textContent="ğŸ’¥ Game Over!";
    revealMines();
    gameOver=true;
    return;
  }

  const n=countMines(i);
  if(n>0){
    c.textContent=n;
    c.classList.add("n"+n);
  } else revealAround(i);
}

function countMines(i){
  return neighbors(i).filter(n=>mines.includes(n)).length;
}

function neighbors(i){
  const x=i%cols, y=Math.floor(i/cols), arr=[];
  for(let dx=-1;dx<=1;dx++)
    for(let dy=-1;dy<=1;dy++){
      if(dx||dy){
        let nx=x+dx, ny=y+dy;
        if(nx>=0&&nx<cols&&ny>=0&&ny<rows)
          arr.push(ny*cols+nx);
      }
    }
  return arr;
}

function revealAround(i){
  neighbors(i).forEach(n=>{
    if(!cells[n].classList.contains("revealed"))
      clickCell(n);
  });
}

function revealMines(){
  mines.forEach(i=>{
    cells[i].textContent="ğŸ’£";
    cells[i].classList.add("mine");
  });
}
</script>
</body>
</html>