<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ğŸ„ Giorno 13 â€“ Buscaminas</title>

<link href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;700&display=swap" rel="stylesheet">

<style>
body{
  margin:0;
  font-family:'Ubuntu',sans-serif;
  background:#7b0412;
  color:#ffd9a0;
  text-align:center;
  user-select:none;
}

h1{color:#ffd700;}

#panel{
  width:90%;
  max-width:420px;
  margin:20px auto;
  background:#fffaf2;
  color:#3a0000;
  border:2px solid #ffd700;
  border-radius:20px;
  padding:20px;
}

.controls{
  display:flex;
  justify-content:center;
  gap:10px;
  margin:10px 0;
}

button{
  padding:10px 16px;
  border-radius:30px;
  border:none;
  font-size:1em;
  font-weight:bold;
  cursor:pointer;
}

.primary{background:#7b0412;color:white;}
.flag{background:#ffd700;color:#3a0000;}
.retry{background:#7b0412;color:white;margin-top:15px;}

#counter{
  font-weight:bold;
  margin-bottom:10px;
}

.grid{
  display:grid;
  grid-template-columns:repeat(8,36px);
  gap:6px;
  justify-content:center;
}

.cell{
  width:36px;
  height:36px;
  background:#3b0a10;
  border-radius:6px;
  font-weight:bold;
  font-size:18px;
  display:flex;
  align-items:center;
  justify-content:center;
  cursor:pointer;
  color:#fffaf2;
}

.cell.revealed{
  background:#fffaf2;
  color:#3a0000;
  cursor:default;
}

.cell.mine{
  background:#ff4b4b;
  color:white;
}

/* numeri */
.n1{color:#007bff;}
.n2{color:#28a745;}
.n3{color:#dc3545;}
.n4{color:#6f42c1;}
.n5{color:#000;}

/* MODAL */
.modal{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,0.65);
  display:flex;
  justify-content:center;
  align-items:center;
  z-index:1000;
}

.modal-box{
  background:#fffaf2;
  padding:25px;
  border-radius:20px;
  width:90%;
  max-width:400px;
  border:2px solid #ffd700;
  color:#3a0000;
}
</style>
</head>

<body>

<div class="modal" id="modal">
  <div class="modal-box">
    <h2>ğŸ„ Giorno 13 â€“ Buscaminas</h2>
    <p>
      ğŸ”¢ I numeri indicano quante bombe ci sono intorno<br><br>
      ğŸ” Usa <b>Scopri</b> per aprire le caselle<br>
      ğŸš© Usa <b>Segna bomba</b> per indicare una bomba<br><br>
      ğŸ¯ Vinci quando individui correttamente <b>3 bombe</b><br>
      ğŸ’£ Se tocchi una bomba perdi
    </p>
    <button class="primary" onclick="startGame()">Inizia a giocare</button>
  </div>
</div>

<h1>ğŸ„ Giorno 13 â€“ Buscaminas</h1>

<div id="panel">
  <div id="counter">Bombe individuate: 0 / 3</div>

  <div class="controls">
    <button class="primary" onclick="mode='reveal'">ğŸ” Scopri</button>
    <button class="flag" onclick="mode='flag'">ğŸš© Segna bomba</button>
  </div>

  <div class="grid" id="grid"></div>

  <button class="retry" onclick="resetGame()">ğŸ”„ Riprova</button>
</div>

<script>
const rows=8, cols=8;
const totalMines=10;
const winTarget=3;

let cells=[], mines=[];
let mode="reveal", gameOver=false;
let found=0;

const grid=document.getElementById("grid");
const counter=document.getElementById("counter");
const modal=document.getElementById("modal");

function startGame(){
  modal.style.display="none";
  resetGame();
}

function resetGame(){
  grid.innerHTML="";
  cells=[]; mines=[]; found=0;
  gameOver=false;
  updateCounter();

  while(mines.length<totalMines){
    let p=Math.floor(Math.random()*rows*cols);
    if(!mines.includes(p)) mines.push(p);
  }

  for(let i=0;i<rows*cols;i++){
    const c=document.createElement("div");
    c.className="cell";
    c.onclick=()=>clickCell(i);
    grid.appendChild(c);
    cells.push(c);
  }
}

function clickCell(i){
  if(gameOver) return;
  const c=cells[i];

  if(mode==="flag"){
    if(c.textContent==="ğŸš©"){
      c.textContent="";
      if(mines.includes(i)){ found--; updateCounter(); }
    }else{
      c.textContent="ğŸš©";
      if(mines.includes(i)){ found++; updateCounter(); checkWin(); }
    }
    return;
  }

  if(c.classList.contains("revealed")) return;
  c.classList.add("revealed");

  if(mines.includes(i)){
    c.textContent="ğŸ’£";
    c.classList.add("mine");
    gameOver=true;
    return;
  }

  const n=countMines(i);
  if(n>0){
    c.textContent=n;
    c.classList.add("n"+n);
  }else revealAround(i);
}

function countMines(i){
  return neighbors(i).filter(n=>mines.includes(n)).length;
}

function neighbors(i){
  const x=i%cols, y=Math.floor(i/cols), arr=[];
  for(let dx=-1;dx<=1;dx++)
    for(let dy=-1;dy<=1;dy++){
      if(dx||dy){
        let nx=x+dx, ny=y+dy;
        if(nx>=0&&nx<cols&&ny>=0&&ny<rows)
          arr.push(ny*cols+nx);
      }
    }
  return arr;
}

function revealAround(i){
  neighbors(i).forEach(n=>{
    if(!cells[n].classList.contains("revealed"))
      clickCell(n);
  });
}

function updateCounter(){
  counter.textContent=`Bombe individuate: ${found} / ${winTarget}`;
}

function checkWin(){
  if(found===winTarget){
    gameOver=true;
    counter.textContent="ğŸ‰ Hai completato il Giorno 13!";
  }
}
</script>
</body>
</html>